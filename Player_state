using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.SceneManagement;

public class Player : MonoBehaviour
{
    private bool isHided;
    [SerializeField] GameObject Hide_ON;
    [SerializeField] GameObject Event_ON;


    void Start()
    {
        isHided = false;
        Event_ON.SetActive(false);
        Hide_ON.SetActive(false);
    }

    void Update()
    {

        Hide();
        Hide_check();
    }

    // Player의 Hide 여부 체크
    void HideCheck()
    {
        if (Input.GetKeyUp(KeyCode.W))
        {
            isHided = true;
            Hide_ON.SetActive(true);
        }
        if (Input.GetKeyUp(KeyCode.R))
        {
            isHided = false;
            Hide_ON.SetActive(false);
        }   
    }

    // 캐릭터가 Hide 상태일때 캐릭터의 tag를 변경해 Enemy가 추적하지 못하게 함
    void Hide()
    {
        if (isHided == true)
        {
            this.tag = "Hide";
        }
        else
        {
            this.tag = "Player";
        }
    }

    // Enemy에게 붙잡히면(닿으면) 게임오버 화면 출력
    private void OnCollisionEnter(Collision col)
    {
        if (col.gameObject.tag == "Enemy")
        {
            SceneManager.LoadScene("Gameover");
        }
    }
    
    // Player 가 Event 의 범위 안에 들어왔을 때, 이벤트 사용 가능 여부 UI 표시
    private void OnTriggerStay(Collider other)
    {
        if (other.tag == "Event")
        {
            Event_ON.SetActive(true);
            if (Input.GetKeyUp(KeyCode.E))
            {
                Debug.Log("Event ON");
            }
        }
    }
    
}
